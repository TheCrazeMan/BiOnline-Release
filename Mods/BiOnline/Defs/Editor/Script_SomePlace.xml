<?xml version="1.0" encoding="utf-8" ?>
<Defs>
	<QuestScriptDef>
		<defName>RandomPlace</defName>
		<rootSelectionWeight>2.2</rootSelectionWeight>
		<rootMinPoints>0</rootMinPoints>
		<autoAccept>true</autoAccept>
		<questNameRules>
			<rulesStrings>
				<li>questName->[verb] [place]</li>
				<li>verb->Unique</li>
				<li>verb->Interesting</li>
				<li>verb->Fortunate</li>
				<li>verb->Uncommon</li>
				<li>place->Shack</li>
				<li>place->Place</li>
				<li>place->Site</li>
				<li>place->Goodies</li>
				<li>place->Supplies</li>
			</rulesStrings>
		</questNameRules>
		<questDescriptionRules>
			<rulesStrings>
				<li>questDescription(askerIsNull==true)->We've intercepted messages about some interesting place with valuable items not far from [map_definite].</li>
			</rulesStrings>
		</questDescriptionRules>
		<modExtensions>
			<li Class="BiOnline.Quests.QuestScriptDefDefModExtension">
				<unknownPlaceGenerationSettings>
					<unknownPlaceGenerationFactionWhitelist>
						<li>PMC</li>
					</unknownPlaceGenerationFactionWhitelist>
				</unknownPlaceGenerationSettings>
			</li>
		</modExtensions>
		<root Class="QuestNode_Sequence">
			<nodes>
				<li Class="QuestNode_GetMap"/>
				<li Class="QuestNode_IsSet">
					<name>asker</name>
					<elseNode Class="QuestNode_RandomNode">
						<nodes>
							<li Class="QuestNode_Set">
								<name>askerIsNull</name>
								<value>true</value>
								<selectionWeight>1</selectionWeight>
							</li>
						</nodes>
					</elseNode>
				</li>
				<li Class="QuestNode_GetSiteTile">
					<storeAs>siteTile</storeAs>
					<preferCloserTiles>true</preferCloserTiles>
				</li>
				<li Class="QuestNode_GetFaction">
					<storeAs>siteFaction</storeAs>
					<allowEnemy>true</allowEnemy>
				</li>
				<li Class="BiOnline.Quests.QuestNode_RandomPlace">
					<storeAs>site</storeAs>
					<faction>$siteFaction</faction>
					<tile>$siteTile</tile>
					<mapBlueprintTags>
						<li>Farmland</li>
					</mapBlueprintTags>
				</li>
				<li Class="QuestNode_SpawnWorldObjects">
					<worldObjects>$site</worldObjects>
				</li>
				<li Class="QuestNode_WorldObjectTimeout">
					<worldObject>$site</worldObject>
					<isQuestTimeout>true</isQuestTimeout>
					<delayTicks>$(randInt(8,35)*60000)</delayTicks>
					<inSignalDisable>site.MapGenerated</inSignalDisable>
					<node Class="QuestNode_Sequence">
						<nodes>
							<li Class="QuestNode_Letter">
								<label TKey="LetterLabelQuestExpired">Quest expired: [resolvedQuestName]</label>
								<text TKey="LetterTextQuestExpired">Intercepted communications indicate the item stash has been claimed by others. The quest [resolvedQuestName] has expired.</text>
							</li>
							<li Class="QuestNode_End">
								<outcome>Fail</outcome>
							</li>
						</nodes>
					</node>
				</li>
				<li Class="QuestNode_NoWorldObject">
					<worldObject>$site</worldObject>
					<node Class="QuestNode_End"/>
				</li>
			</nodes>
		</root>
	</QuestScriptDef>
	
	<QuestScriptDef>
		<defName>MeteoriteFall</defName>
		<rootSelectionWeight>2.2</rootSelectionWeight>
		<rootMinPoints>0</rootMinPoints>
		<autoAccept>true</autoAccept>
		<questNameRules>
			<rulesStrings>
				<li>questName->[verb] [place]</li>
				<li>verb->Falling</li>
				<li>place->meteorite</li>
				<li>place->meteorite fragments</li>
			</rulesStrings>
		</questNameRules>
		<questDescriptionRules>
			<rulesStrings>
				<li>questDescription(askerIsNull==true)->A bright glowing object flashed in the sky, which then exploded into several pieces and fell to the ground with a clatter. [map_definite].</li>
			</rulesStrings>
		</questDescriptionRules>
		<root Class="QuestNode_Sequence">
			<nodes>
				<li Class="QuestNode_GetMap"/>
				<li Class="QuestNode_IsSet">
					<name>asker</name>
					<elseNode Class="QuestNode_RandomNode">
						<nodes>
							<li Class="QuestNode_Set">
								<name>askerIsNull</name>
								<value>true</value>
								<selectionWeight>1</selectionWeight>
							</li>
						</nodes>
					</elseNode>
				</li>
				<li Class="QuestNode_GetSiteTile">
					<storeAs>siteTile</storeAs>
					<preferCloserTiles>true</preferCloserTiles>
				</li>
				<li Class="QuestNode_GetFaction">
					<storeAs>siteFaction</storeAs>
					<allowEnemy>true</allowEnemy>
				</li>
				<li Class="BiOnline.Quests.QuestNode_RandomPlace">
					<storeAs>site</storeAs>
					<faction>$siteFaction</faction>
					<tile>$siteTile</tile>
					<mapBlueprintTags>
						<li>MeteoriteFall</li>
					</mapBlueprintTags>
				</li>
				<li Class="QuestNode_SpawnWorldObjects">
					<worldObjects>$site</worldObjects>
				</li>
				<li Class="QuestNode_WorldObjectTimeout">
					<worldObject>$site</worldObject>
					<isQuestTimeout>true</isQuestTimeout>
					<delayTicks>$(randInt(8,35)*60000)</delayTicks>
					<inSignalDisable>site.MapGenerated</inSignalDisable>
					<node Class="QuestNode_Sequence">
						<nodes>
							<li Class="QuestNode_Letter">
								<label TKey="LetterLabelQuestExpired">Quest expired: [resolvedQuestName]</label>
								<text TKey="LetterTextQuestExpired">Meteorite [resolvedQuestName] is no longer showing up on our scanner. Someone else must have dug it up. The time allotted for task [resolvedQuestName] has expired.</text>
							</li>
							<li Class="QuestNode_End">
								<outcome>Fail</outcome>
							</li>
						</nodes>
					</node>
				</li>
				<li Class="QuestNode_NoWorldObject">
					<worldObject>$site</worldObject>
					<node Class="QuestNode_End"/>
				</li>
			</nodes>
		</root>
	</QuestScriptDef>
	
</Defs>